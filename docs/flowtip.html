<!DOCTYPE html>

<html>
<head>
  <title>FlowTip</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1>FlowTip</h1>
<p><em>A flexible, adaptable and easy to use tooltip positioning library.</em></p>
<p>Click <a href="demo.html">here</a> for to see a demo.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="class"><span class="keyword">class</span> @<span class="title">FlowTip</span></span>

  FlowTip: <span class="string">"2.0"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h3">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h3>Create a FlowTip</h3>
<p>Call <strong>FlowTip</strong>&#39;s constructor, optionally with some of the attributes listed below:</p>
<pre><code>var myFlowTip = new FlowTip({
    region: &quot;bottom&quot;
    className: &quot;my-tip&quot;
    hasTail: false
})</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  constructor: (options = {}) -&gt;
    <span class="keyword">for</span> option <span class="keyword">of</span> options
      <span class="keyword">if</span> _.has(options, option) &amp;&amp; options[option] != <span class="literal">undefined</span>
        <span class="keyword">this</span>[option] = options[option]</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap for-h3">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h3>Attributes</h3>
<p><code>className</code>: <strong>String</strong>; Additional class name(s) for the container of the tooltip.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  className: <span class="string">""</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p><code>contentClassName</code>: <strong>String</strong>; Additional class name(s) for the tooltip&#39;s content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  contentClassName: <span class="string">""</span></pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p><code>tailClassName</code>: <strong>String</strong>; Additional class name(s) for the tooltip&#39;s tail.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tailClassName: <span class="string">""</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p><code>appendTo</code>: <strong>Element</strong>; The element within which the tooltip will be inserted into.
Default value is the document&#39;s <code>body</code> and the tooltip would thus be free to move/appear
anywhere on the page and edge detection will only be performed on the edge of the page.
If <code>appendTo</code> is set to a element in the page, edge detection will be performed on the edge of
the element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  appendTo: <span class="literal">null</span></pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p><code>tooltipContent</code>: <strong>String</strong> | <strong>Element</strong>; The content of the tooltip. May be specified as
(HTML) string or DOM element. Can be (re)set by calling <code>setTooltipContent(...)</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tooltipContent: <span class="literal">null</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p><code>region</code>: <strong>String</strong>; The preferred region in which the tooltip will appear relative to its
target. Possibly values are: <code>top</code>, <code>bottom</code>, <code>left</code> and <code>right</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  region: <span class="string">"top"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p><code>persevere</code>: <strong>Boolean</strong>; If set to <code>true</code>, the tooltip will be reverted back to its preferred
region whenever possible (i.e. whenever there is enough space in that region). If set
to <code>false</code>, the tooltip will remain in the region edge detection puts it in until edge detection
changes it again.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  persevere: <span class="literal">false</span></pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p><code>hasTail</code>: <strong>Boolean</strong>; Controls if the tooltip has a &quot;tail&quot; that remains pointing to the
tooltip&#39;s target.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  hasTail: <span class="literal">true</span>

  animated: <span class="literal">false</span>

  width: <span class="literal">null</span>
  height: <span class="string">"auto"</span>
  minWidth: <span class="literal">null</span>
  minHeight: <span class="literal">null</span>
  maxWidth: <span class="literal">null</span>
  maxHeight: <span class="literal">null</span>

  tailWidth: <span class="number">20</span>
  tailHeight: <span class="number">10</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p><code>targetOffset</code>: <strong>Integer</strong>; The distance between:</p>
<ul>
<li>the edge of the tooltip&#39;s target in the current region</li>
<li>the closest edge of the tooltip&#39;s root (or tail; see <code>targetOffsetFrom</code> below) to the target&#39;s
edge</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>  targetOffset: <span class="number">10</span></pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p><code>rotationOffset</code>: <strong>Integer</strong>; The distance between two closest edges of:</p>
<ul>
<li>the boundary representive of the tooltip&#39;s <code>appendTo</code> attribute</li>
<li>the target of the tooltip</li>
</ul>
<p>... beyond which point edge detection will cause the tooltip to be rotated to an adjacent
region.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  rotationOffset: <span class="number">30</span></pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p><code>edgeOffset</code>: <strong>Integer</strong>; The distance between two closest edges of:</p>
<ul>
<li>the boundary representive of the tooltip&#39;s <code>appendTo</code> attribute</li>
<li>the target of the tooltip</li>
</ul>
<p>... beyond which point edge detection will cause the tooltip to be flipped to an opposit region.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  edgeOffset: <span class="number">30</span></pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p><code>targetOffsetFrom</code>: <strong>String</strong>; Possible values are <code>root</code> and <code>tail</code>. When set to <code>root</code>,
<code>targetOffset</code> will be calculated against the edge of the tooltip&#39;s root; When set to <code>tail</code>,
<code>targetOffset</code> will take the tooltip&#39;s tail into account.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  targetOffsetFrom: <span class="string">"root"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap for-h3">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h3>Alignments</h3>
<p>Tooltip&#39;s alignments are divided into <strong>root alignment</strong> and <strong>target alignment</strong>, each with
a corresponding <strong>offset</strong> attribute that controls the direction of the alignment and offset
amount.</p>
<h5>Alignment Pivot</h5>
<p>When talking about alignments, it&#39;s easiest to reference an imaginary &quot;pivot&quot; to which both the
tooltip and its target are aligned to. For example, if both the tooltip&#39;s root and its target
are set to &quot;center&quot; align, then this &quot;pivot&quot; would be a line that would run across the center of
both elements.</p>
<p>The alignment pivot can also be seen as <em>the point at which the tooltip is &quot;pointing&quot; at the
target</em>.</p>
<h5>Root Alignment</h5>
<p>Root alignment referrs to the alignment of the tooltip&#39;s root relative to the pivot.</p>
<p><code>rootAlign</code>: <strong>String</strong>; Possible values are <code>center</code> and <code>edge</code>. When set to <code>center</code>, the
tooltip&#39;s root will be center aligned against the pivot. When set to <code>edge</code>, one of the
tooltip&#39;s root&#39;s edge will be aligned against the pivot. See <code>rootAlignOffset</code> for the
exact mechanics of the two values. This value can also be specified on a per-region basis via
<code>[top|bottom|left|right]RootAlign</code>, and if a region&#39;s specific value is absence, the value from
<code>rootAlign</code> will be used.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  rootAlign: <span class="string">"center"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p><code>rootAlignOffset</code>: <strong>Integer</strong></p>
<p>If <code>rootAlign</code> is set to <code>center</code>, this attribute controls the clockwise distance from the
pivot the tooltip&#39;s root will shift. When this value is positive, the root will shift clockwise,
and counter-clockwise when this value is negative.</p>
<p>If <code>rootAlign</code> is set to <code>edge</code>, one of the tooltip&#39;s root&#39;s edge will be aligned against the
pivot. When this attribute is positive, the clockwise edge will be used and the
counter-clockwise edge will be used when this attribute is negative. The absolute value of this
attribute controls the amount away from that edge the tooltip&#39;s root will shift.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  rootAlignOffset: <span class="number">0</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap for-h5">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h5>Target Alignment</h5>
<p>Target alignment refers to the alignment of the pivot relative to the target of the tooltip.</p>
<p><code>targetAlign</code>: <strong>String</strong>; Possible values are <code>center</code> and <code>edge</code>. When set to <code>center</code>, the
pivot will be center aligned against the target. When set to <code>edge</code>, one of the pivot&#39;s edge
will be aligned against the pivot. See <code>targetAlignOffset</code> for the exact mechanics of the two
values. This value can also be specified on a per-region basis via
<code>[top|bottom|left|right]TargetAlign</code>, and if a region&#39;s specific value is absence, the value
from <code>targetAlign</code> will be used.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  targetAlign: <span class="string">"center"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p><code>rootAlignOffset</code>: <strong>Integer</strong></p>
<p>If <code>targetAlign</code> is set to <code>center</code>, this attribute controls the clockwise distance from the
pivot the target will be effectively shift (i.e. the target will not move, but the pivot will
shift in the opposite direction). When this value is positive, the pivot will effectively shift
clockwise, and counter-clockwise when this value is negative.</p>
<p>If <code>targetAlign</code> is set to <code>edge</code>, one of the target&#39;s edge will be aligned against the
pivot. When this attribute is positive, the clockwise edge will be used and the
counter-clockwise edge will be used when this attribute is negative. The absolute value of this
attribute controls the amount away from that edge the target will effectively shift.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  targetAlignOffset: <span class="number">0</span></pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p><code>render</code>: Render the tooltip&#39;s root (if not already rendered), content and insert the tooltip
into the DOM. If called repeately, only re-render the tooltip&#39;s content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  render: -&gt;
    <span class="keyword">return</span> <span class="property">@_renderContent</span>() <span class="keyword">if</span> <span class="property">@$root</span>

    <span class="property">@root</span> = document.createElement(<span class="string">"div"</span>)
    <span class="property">@root</span>.className = <span class="string">"flowtip <span class="subst">#{@className}</span>"</span>
    <span class="property">@root</span>.style.position = <span class="string">"absolute"</span>
    <span class="property">@root</span>.style.display = <span class="string">"none"</span>

    <span class="property">@content</span> = document.createElement(<span class="string">"div"</span>)
    <span class="property">@content</span>.className = <span class="string">"flowtip-content <span class="subst">#{@contentClassName}</span>"</span>
    <span class="property">@_renderContent</span>()
    <span class="property">@_repositionCount</span> = <span class="number">0</span>
    <span class="property">@root</span>.appendChild(<span class="property">@content</span>)

    <span class="property">@tail</span> = document.createElement(<span class="string">"div"</span>)
    <span class="property">@tail</span>.className = <span class="string">"flowtip-tail <span class="subst">#{@tailClassName}</span>"</span>
    <span class="property">@tail</span>.style.position = <span class="string">"absolute"</span>
    <span class="property">@tail</span>.appendChild(document.createElement(<span class="string">"div"</span>))
    <span class="property">@root</span>.appendChild(<span class="property">@tail</span>)

    <span class="property">@$root</span> = $(<span class="property">@root</span>)
    <span class="property">@$content</span> = $(<span class="property">@content</span>)
    <span class="property">@$tail</span> = $(<span class="property">@tail</span>)
    <span class="property">@$appendTo</span> = $(<span class="property">@appendTo</span> ||= document.body)

    <span class="property">@_insertToDOM</span>()</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p><code>setTarget</code>: Set/update the tooltip&#39;s target. The target is the element to which the
tooltip will be pointing at.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  setTarget: (target) -&gt;
    <span class="property">@$target</span> = $(target)
    <span class="property">@target</span> = <span class="property">@$target</span>[<span class="number">0</span>]</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p><code>setTooltipContent</code>: Set/update the tooltip&#39;s content. If <code>render</code> is set to <code>true</code> for
<code>options</code>, the <code>render()</code> method will be called to re-render the content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  setTooltipContent: (content, options = {}) -&gt;
    <span class="property">@tooltipContent</span> = content
    <span class="property">@render</span>() <span class="keyword">if</span> options.render</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p><code>reposition</code>: Perform edge detection and position calculations to update the tooltip&#39;s
position.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  reposition: -&gt;
    <span class="keyword">return</span> <span class="keyword">unless</span> <span class="property">@target</span>

    <span class="property">@$root</span>.width(<span class="property">@width</span>)
    <span class="property">@$root</span>.height(<span class="property">@height</span>)
    <span class="property">@$root</span>.css({
      minWidth: <span class="property">@minWidth</span>
      minHeight: <span class="property">@minHeight</span>
      maxWidth: <span class="property">@maxWidth</span>
      maxHeight: <span class="property">@maxHeight</span>
    })

    <span class="keyword">if</span> <span class="property">@width</span> == <span class="string">"auto"</span> || <span class="property">@height</span> == <span class="string">"auto"</span>
      <span class="property">@content</span>.style.position = <span class="string">"relative"</span>

    <span class="property">@$tail</span>.width(<span class="property">@tailWidth</span>)
    <span class="property">@$tail</span>.height(<span class="property">@tailHeight</span>)

    <span class="property">@_updateRegion</span>()
    <span class="property">@_updatePosition</span>()</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p><code>show</code>: Show the tooltip. Also update the tooltip&#39;s <code>visible</code> attribute.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  show: -&gt;
    <span class="keyword">return</span> <span class="keyword">if</span> <span class="property">@visible</span>

    <span class="property">@render</span>()
    <span class="property">@visible</span> = <span class="literal">true</span>
    <span class="property">@root</span>.style.opacity = <span class="number">0</span>
    <span class="property">@root</span>.style.display = <span class="string">"block"</span>

    _.delay =&gt;
      <span class="property">@reposition</span>()
      <span class="property">@root</span>.style.opacity = <span class="number">1</span>
      <span class="property">@$root</span>.addClass(<span class="string">"animated"</span>) <span class="keyword">if</span> <span class="property">@animated</span>
      <span class="property">@trigger</span>(<span class="string">"show"</span>)
    , <span class="number">16</span></pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p><code>hide</code>: Hide the tooltip. Also update the tooltip&#39;s <code>visible</code> attribute.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  hide: -&gt;
    <span class="keyword">return</span> <span class="keyword">unless</span> <span class="property">@visible</span>

    <span class="property">@visible</span> = <span class="literal">false</span>
    <span class="property">@root</span>.style.display = <span class="string">"none"</span>

    <span class="property">@trigger</span>(<span class="string">"hide"</span>)
    <span class="property">@$root</span>.removeClass(<span class="string">"animated"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p><code>trigger</code>: Trigger an event from the root of the tooltip.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  trigger: (eventName) -&gt;
    <span class="property">@$root</span>.trigger(<span class="string">"<span class="subst">#{eventName}</span>.flowtip"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p><code>destroy()</code>: Remove the tooltip&#39;s root from DOM.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  destroy: -&gt;
    <span class="property">@$root</span>.remove() <span class="keyword">if</span> <span class="property">@$root</span></pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap for-h5">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <h5>Private Methods</h5>
<p><em>Hitherto shalt thou come, but no further.</em></p>
<p><code>_updateRegion</code>: Performs edge detection and place the tooltip in a different if the current one
it&#39;s in doesn&#39;t have enough space.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _updateRegion: (position) -&gt;
    <span class="property">@_region</span> ||= <span class="property">@region</span>
    <span class="property">@_region</span> = <span class="property">@region</span> <span class="keyword">if</span> <span class="property">@persevere</span>

    position = <span class="property">@_calculatePosition</span>(<span class="property">@_region</span>)
    rootDimension = <span class="property">@_rootDimension</span>()
    parentParameter = <span class="property">@_parentParameter</span>()
    targetParameter = <span class="property">@_targetParameter</span>()

    <span class="keyword">switch</span> <span class="property">@_region</span>
      <span class="keyword">when</span> <span class="string">"top"</span>
        <span class="keyword">if</span> position.top - <span class="property">@edgeOffset</span> &lt; parentParameter.top
          <span class="property">@_region</span> = <span class="string">"bottom"</span>
      <span class="keyword">when</span> <span class="string">"bottom"</span>
        <span class="keyword">if</span> position.top + rootDimension.height + <span class="property">@edgeOffset</span> &gt; parentParameter.top + parentParameter.height
          <span class="property">@_region</span> = <span class="string">"top"</span>
      <span class="keyword">when</span> <span class="string">"left"</span>
        <span class="keyword">if</span> position.left - <span class="property">@edgeOffset</span> &lt; parentParameter.left
          <span class="property">@_region</span> = <span class="string">"right"</span>
      <span class="keyword">when</span> <span class="string">"right"</span>
        <span class="keyword">if</span> position.left + rootDimension.width + <span class="property">@edgeOffset</span> &gt; parentParameter.left + parentParameter.width
          <span class="property">@_region</span> = <span class="string">"left"</span>

    <span class="keyword">switch</span> <span class="property">@_region</span>
      <span class="keyword">when</span> <span class="string">"top"</span>, <span class="string">"bottom"</span>
        <span class="keyword">if</span> (parentParameter.left + parentParameter.width) - (targetParameter.left + (targetParameter.width / <span class="number">2</span>)) - <span class="property">@edgeOffset</span> &lt; <span class="property">@rotationOffset</span>
          <span class="property">@_region</span> = <span class="string">"left"</span>
        <span class="keyword">else</span> <span class="keyword">if</span> targetParameter.left + (targetParameter.width / <span class="number">2</span>) - parentParameter.left - <span class="property">@edgeOffset</span> &lt; <span class="property">@rotationOffset</span>
          <span class="property">@_region</span> = <span class="string">"right"</span>
      <span class="keyword">when</span> <span class="string">"left"</span>, <span class="string">"right"</span>
        <span class="keyword">if</span> (parentParameter.top + parentParameter.height) - (targetParameter.top + (targetParameter.height / <span class="number">2</span>)) - <span class="property">@edgeOffset</span> &lt; <span class="property">@rotationOffset</span>
          <span class="property">@_region</span> = <span class="string">"top"</span>
        <span class="keyword">else</span> <span class="keyword">if</span> targetParameter.top + (targetParameter.height / <span class="number">2</span>) - parentParameter.top - <span class="property">@edgeOffset</span> &lt; <span class="property">@rotationOffset</span>
          <span class="property">@_region</span> = <span class="string">"bottom"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p><code>_updatePosition</code>: Update tooltip&#39;s elements&#39; positions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _updatePosition: (position) -&gt;
    position = <span class="property">@_calculatePosition</span>(<span class="property">@_region</span>)

    <span class="property">@root</span>.style.top = <span class="string">"<span class="subst">#{position.top}</span>px"</span>
    <span class="property">@root</span>.style.left = <span class="string">"<span class="subst">#{position.left}</span>px"</span>

    rootHeight = <span class="property">@$root</span>.height()
    contentHeight = <span class="property">@$content</span>.height()
    contentOuterHeight = <span class="property">@$content</span>.outerHeight(<span class="literal">true</span>)
    contentSpacing = contentOuterHeight - contentHeight

    <span class="keyword">if</span> contentOuterHeight &gt; rootHeight
      <span class="property">@content</span>.style.maxHeight = <span class="string">"<span class="subst">#{rootHeight - contentSpacing}</span>px"</span>
      <span class="property">@$root</span>.addClass(<span class="string">"content-overflow"</span>)

    <span class="keyword">if</span> <span class="property">@hasTail</span>
      <span class="property">@tail</span>.style.display = <span class="string">"block"</span>
      <span class="property">@tail</span>.style.top = <span class="string">"<span class="subst">#{position.tail.top}</span>px"</span>
      <span class="property">@tail</span>.style.left = <span class="string">"<span class="subst">#{position.tail.left}</span>px"</span>
      <span class="property">@tail</span>.style.width = <span class="string">"<span class="subst">#{position.tail.width}</span>px"</span>
      <span class="property">@tail</span>.style.height = <span class="string">"<span class="subst">#{position.tail.height}</span>px"</span>
      <span class="property">@tail</span>.className = <span class="string">"flowtip-tail <span class="subst">#{@tailClassName}</span> <span class="subst">#{@_tailType(@_region)}</span>"</span>
    <span class="keyword">else</span>
      <span class="property">@tail</span>.style.display = <span class="string">"none"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p><code>_calculatePosition</code>: Calculate the would-be position of the tooltip for the given region.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _calculatePosition: (region) -&gt;
    rootDimension = <span class="property">@_rootDimension</span>()
    parentParameter = <span class="property">@_parentParameter</span>()
    targetParameter = <span class="property">@_targetParameter</span>()

    tailWidth = <span class="number">0</span>
    tailHeight = <span class="number">0</span>
    <span class="keyword">if</span> <span class="property">@hasTail</span>
      tailDimension = <span class="property">@_tailDimension</span>(region)
      tailWidth = tailDimension.width
      tailHeight = tailDimension.height

    position = {}

    effectiveTargetOffset = <span class="keyword">if</span> <span class="property">@targetOffsetFrom</span> == <span class="string">"root"</span>
      <span class="property">@targetOffset</span>
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="property">@targetOffsetFrom</span> == <span class="string">"tail"</span>
      <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"bottom"</span>
        tailHeight + <span class="property">@targetOffset</span>
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"left"</span> || region == <span class="string">"right"</span>
        tailWidth + <span class="property">@targetOffset</span>

    <span class="keyword">switch</span> region
      <span class="keyword">when</span> <span class="string">"top"</span>
        position = {
          top: targetParameter.top - rootDimension.height - effectiveTargetOffset
          left: <span class="property">@_rootPivot</span>(region, targetParameter, rootDimension)
          tail: { top: rootDimension.height }
        }
      <span class="keyword">when</span> <span class="string">"bottom"</span>
        position = {
          top: targetParameter.top + targetParameter.height + effectiveTargetOffset
          left: <span class="property">@_rootPivot</span>(region, targetParameter, rootDimension)
          tail: { top: -(tailHeight) }
        }
      <span class="keyword">when</span> <span class="string">"left"</span>
        position = {
          top: <span class="property">@_rootPivot</span>(region, targetParameter, rootDimension)
          left: targetParameter.left - rootDimension.width - effectiveTargetOffset
          tail: { left: rootDimension.width }
        }
      <span class="keyword">when</span> <span class="string">"right"</span>
        position = {
          top: <span class="property">@_rootPivot</span>(region, targetParameter, rootDimension)
          left: targetParameter.left + targetParameter.width + effectiveTargetOffset
          tail: { left: -(tailWidth) }
        }

    <span class="keyword">switch</span> region
      <span class="keyword">when</span> <span class="string">"top"</span>, <span class="string">"bottom"</span>
        <span class="keyword">if</span> position.left &lt; parentParameter.left + <span class="property">@edgeOffset</span>
          position.left = parentParameter.left + <span class="property">@edgeOffset</span>
        <span class="keyword">else</span> <span class="keyword">if</span> position.left + rootDimension.width &gt; parentParameter.left + parentParameter.width - <span class="property">@edgeOffset</span>
          position.left = parentParameter.left + parentParameter.width - rootDimension.width - <span class="property">@edgeOffset</span>
      <span class="keyword">when</span> <span class="string">"left"</span>, <span class="string">"right"</span>
        <span class="keyword">if</span> position.top &lt; parentParameter.top + <span class="property">@edgeOffset</span>
          position.top = parentParameter.top + <span class="property">@edgeOffset</span>
        <span class="keyword">else</span> <span class="keyword">if</span> position.top + rootDimension.height &gt; parentParameter.top + parentParameter.height - <span class="property">@edgeOffset</span>
          position.top = parentParameter.top + parentParameter.height - rootDimension.height - <span class="property">@edgeOffset</span>

    <span class="keyword">if</span> <span class="property">@hasTail</span>
      position.tail = <span class="keyword">switch</span> region
        <span class="keyword">when</span> <span class="string">"top"</span>
          {
            top: rootDimension.height
            left: <span class="property">@_tailPivot</span>(region, targetParameter, tailDimension, position)
          }
        <span class="keyword">when</span> <span class="string">"bottom"</span>
          {
            top: -(tailHeight)
            left: <span class="property">@_tailPivot</span>(region, targetParameter, tailDimension, position)
          }
        <span class="keyword">when</span> <span class="string">"left"</span>
          {
            top: <span class="property">@_tailPivot</span>(region, targetParameter, tailDimension, position)
            left: rootDimension.width
          }
        <span class="keyword">when</span> <span class="string">"right"</span>
          {
            top: <span class="property">@_tailPivot</span>(region, targetParameter, tailDimension, position)
            left: -(tailWidth)
          }
      position.tail.width = tailWidth
      position.tail.height = tailHeight

    position

  _insertToDOM: -&gt;</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Ensure &quot;appendTo&quot; is &quot;position&quot;&#39;ed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> <span class="property">@appendTo</span>.style.position == <span class="string">""</span>
      <span class="property">@appendTo</span>.style.position = <span class="string">"relative"</span>
    <span class="property">@appendTo</span>.appendChild(<span class="property">@root</span>)

  _renderContent: -&gt;
    <span class="keyword">if</span> <span class="keyword">typeof</span>(<span class="property">@tooltipContent</span>) == <span class="string">"string"</span>
      $(<span class="property">@content</span>).html(<span class="property">@tooltipContent</span>)
    <span class="keyword">else</span>
      <span class="property">@$tooltipContent</span> = $(<span class="property">@tooltipContent</span>)
      <span class="property">@content</span>.innerHTML = <span class="string">""</span>
      <span class="keyword">if</span> <span class="property">@$tooltipContent</span>.length
        <span class="property">@content</span>.appendChild(<span class="property">@$tooltipContent</span>[<span class="number">0</span>])

  _rootPivot: (region, targetParameter, rootDimension) -&gt;
    targetPivot = <span class="property">@_targetPivot</span>(region, targetParameter)

    rootAlign = <span class="property">@_rootAlign</span>(region)
    rootAlignOffset = <span class="property">@_rootAlignOffset</span>(region)

    <span class="keyword">if</span> rootAlign == <span class="string">"center"</span>
      pivot = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"bottom"</span>
        targetPivot - (rootDimension.width / <span class="number">2</span>)
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"left"</span> || region == <span class="string">"right"</span>
        targetPivot - (rootDimension.height / <span class="number">2</span>)

      effectiveOffset = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"right"</span>
        rootAlignOffset
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"bottom"</span> || region == <span class="string">"left"</span>
        -rootAlignOffset
    <span class="keyword">else</span> <span class="keyword">if</span> rootAlign == <span class="string">"edge"</span>
      pivots = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"bottom"</span>
        [targetPivot, targetPivot - rootDimension.width]
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"left"</span> || region == <span class="string">"right"</span>
        [targetPivot, targetPivot - rootDimension.height]

      positive = rootAlignOffset &gt;= <span class="number">0</span>
      pivot = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"right"</span>
        <span class="keyword">if</span> positive <span class="keyword">then</span> pivots[<span class="number">1</span>] <span class="keyword">else</span> pivots[<span class="number">0</span>]
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"bottom"</span> || region == <span class="string">"left"</span>
        <span class="keyword">if</span> positive <span class="keyword">then</span> pivots[<span class="number">0</span>] <span class="keyword">else</span> pivots[<span class="number">1</span>]

      effectiveOffset = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"right"</span>
        rootAlignOffset
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"bottom"</span> || region == <span class="string">"left"</span>
        -rootAlignOffset

    <span class="keyword">return</span> pivot + effectiveOffset + <span class="property">@_targetAlignmentOffset</span>(region, targetParameter)

  _tailPivot: (region, targetParameter, tailDimension, rootPosition) -&gt;
    targetPivot = <span class="property">@_targetPivot</span>(region, targetParameter)

    pivot = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"bottom"</span>
      targetPivot - rootPosition.left - (tailDimension.width / <span class="number">2</span>)
    <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"left"</span> || region == <span class="string">"right"</span>
      targetPivot - rootPosition.top - (tailDimension.height / <span class="number">2</span>)

    effectiveOffset = <span class="property">@_targetAlignmentOffset</span>(region, targetParameter)

    <span class="keyword">return</span> pivot + effectiveOffset

  _targetPivot: (region, targetParameter) -&gt;
    targetAlign = <span class="property">@_targetAlign</span>(region)
    targetAlignOffset = <span class="property">@_targetAlignOffset</span>(region)

    <span class="keyword">if</span> targetAlign == <span class="string">"center"</span>
      pivot = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"bottom"</span>
        targetParameter.left + (targetParameter.width / <span class="number">2</span>)
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"left"</span> || region == <span class="string">"right"</span>
        targetParameter.top + (targetParameter.height / <span class="number">2</span>)
    <span class="keyword">else</span> <span class="keyword">if</span> targetAlign == <span class="string">"edge"</span>
      pivots = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"bottom"</span>
        [targetParameter.left, targetParameter.left + targetParameter.width]
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"left"</span> || region == <span class="string">"right"</span>
        [targetParameter.top, targetParameter.top + targetParameter.height]

      positive = targetAlignOffset &gt;= <span class="number">0</span>
      pivot = <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"right"</span>
        <span class="keyword">if</span> positive <span class="keyword">then</span> pivots[<span class="number">1</span>] <span class="keyword">else</span> pivots[<span class="number">0</span>]
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"bottom"</span> || region == <span class="string">"left"</span>
        <span class="keyword">if</span> positive <span class="keyword">then</span> pivots[<span class="number">0</span>] <span class="keyword">else</span> pivots[<span class="number">1</span>]

    <span class="keyword">return</span> pivot

  _targetAlignmentOffset: (region, targetParameter) -&gt;
    targetAlign = <span class="property">@_targetAlign</span>(region)
    targetAlignOffset = <span class="property">@_targetAlignOffset</span>(region)

    <span class="keyword">if</span> targetAlign == <span class="string">"center"</span>
      <span class="keyword">return</span> <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"right"</span>
        targetAlignOffset
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"bottom"</span> || region == <span class="string">"left"</span>
        -targetAlignOffset
    <span class="keyword">else</span> <span class="keyword">if</span> targetAlign == <span class="string">"edge"</span>
      positive = targetAlignOffset &gt;= <span class="number">0</span>
      <span class="keyword">return</span> <span class="keyword">if</span> region == <span class="string">"top"</span> || region == <span class="string">"right"</span>
        -targetAlignOffset
      <span class="keyword">else</span> <span class="keyword">if</span> region == <span class="string">"bottom"</span> || region == <span class="string">"left"</span>
        targetAlignOffset

  _rootAlign: (region) -&gt;
    <span class="keyword">this</span>[<span class="string">"<span class="subst">#{region}</span>RootAlign"</span>] || <span class="property">@rootAlign</span>

  _rootAlignOffset: (region) -&gt;
    <span class="keyword">this</span>[<span class="string">"<span class="subst">#{region}</span>RootAlignOffset"</span>] || <span class="property">@rootAlignOffset</span>

  _targetAlign: (region) -&gt;
    <span class="keyword">this</span>[<span class="string">"<span class="subst">#{region}</span>TargetAlign"</span>] || <span class="property">@targetAlign</span>

  _targetAlignOffset: (region) -&gt;
    <span class="keyword">this</span>[<span class="string">"<span class="subst">#{region}</span>TargetAlignOffset"</span>] || <span class="property">@targetAlignOffset</span>

  _rootDimension: -&gt;
    { width: <span class="property">@$root</span>.width(), height: <span class="property">@$root</span>.height() }

  _tailDimension: (region) -&gt;
    dimension = <span class="keyword">if</span> <span class="property">@tail</span>.getAttribute(<span class="string">"original-width"</span>) &amp;&amp; <span class="property">@tail</span>.getAttribute(<span class="string">"original-height"</span>)
      { width: parseInt(<span class="property">@tail</span>.getAttribute(<span class="string">"original-width"</span>)), height: parseInt(<span class="property">@tail</span>.getAttribute(<span class="string">"original-height"</span>)) }
    <span class="keyword">else</span>
      <span class="property">@tail</span>.setAttribute(<span class="string">"original-width"</span>, width = <span class="property">@$tail</span>.width())
      <span class="property">@tail</span>.setAttribute(<span class="string">"original-height"</span>, height = <span class="property">@$tail</span>.height())
      { width: width, height: height }

    <span class="keyword">if</span> region == <span class="string">"left"</span> || region == <span class="string">"right"</span>
      { width: dimension.height, height: dimension.width }
    <span class="keyword">else</span>
      dimension

  _tailType: (region) -&gt;
    <span class="keyword">switch</span> region
      <span class="keyword">when</span> <span class="string">"top"</span>
        <span class="keyword">return</span> <span class="string">"bottom"</span>
      <span class="keyword">when</span> <span class="string">"bottom"</span>
        <span class="keyword">return</span> <span class="string">"top"</span>
      <span class="keyword">when</span> <span class="string">"left"</span>
        <span class="keyword">return</span> <span class="string">"right"</span>
      <span class="keyword">when</span> <span class="string">"right"</span>
        <span class="keyword">return</span> <span class="string">"left"</span>

  _targetParameter: -&gt;
    targetOffset = <span class="property">@$target</span>.offset()
    parentOffset = <span class="property">@$appendTo</span>.offset()

    {
      top: targetOffset.top - parentOffset.top
      left: targetOffset.left - parentOffset.left
      height: <span class="property">@$target</span>.outerHeight()
      width: <span class="property">@$target</span>.outerWidth()
    }

  _parentParameter: -&gt;
    parentOffset = <span class="property">@$appendTo</span>.offset()
    {
      top: parentOffset.top
      left: parentOffset.left
      height: <span class="property">@$appendTo</span>.outerHeight()
      width: <span class="property">@$appendTo</span>.outerWidth()
    }</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
